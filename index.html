<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>GitHub 電子書閱讀器</title>
    <style>
        :root {
            /* --- 修改點 1：調整尺寸策略 --- */
            /* 不再使用固定的寬高比例，而是根據螢幕高度動態調整 */
            /* 這樣確保在手機上，書本不會大到把按鈕擠出畫面 */
            --book-height: calc(100vh - 140px); /* 預留 140px 給控制列 */
            --book-width: calc((100vh - 140px) * 0.65); /* 根據高度自動算出寬度 (約 2:3 比例) */
            
            /* 如果螢幕很寬（電腦版），限制最大寬度 */
            --max-width: 500px;
            --max-height: 750px; 

            --bg-color: #444;
        }

        /* 手機版適配：如果算出來的寬度超過螢幕寬度，則改以寬度為基準 */
        @media (max-width: 600px) {
            :root {
                 /* 確保書本寬度不超過螢幕的 95% */
                 --safe-width: 95vw;
                 /* 比較一下，如果高度算出來的寬度太寬，就用螢幕寬度 */
            }
        }

        * { box-sizing: border-box; }

        body {
            margin: 0;
            padding: 0;
            background-color: var(--bg-color);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center; /* 垂直置中 */
            height: 100vh; /* 鎖定為螢幕高度 */
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            overflow: hidden; 
        }

        .viewport-container {
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 10px 0;
        }

        /* 電子書容器 */
        .book-stage {
            /* 優先使用 CSS 變數，但加上 max-width 限制 */
            width: var(--book-width);
            height: var(--book-height);
            
            /* 雙重保險：確保在手機上不會寬出螢幕 */
            max-width: 90vw; 
            /* 如果寬度被 max-width 限制了，高度也要等比縮小，這裡用 object-fit 的概念處理容器較難，
               所以我們主要依賴上面的 calc 計算。但在極端細長的手機，可能左右會有空隙，這是正常的。 */

            position: relative;
            perspective: 1500px; 
            margin-bottom: 20px; /* 與控制列的距離 */
        }

        .book {
            width: 100%;
            height: 100%;
            position: relative;
            transform-style: preserve-3d;
            border-radius: 4px; /* 稍微縮小圓角 */
            transition: transform 0.4s ease;
        }

        /* 頁面樣式 */
        .page {
            width: 100%;
            height: 100%;
            position: absolute;
            top: 0;
            left: 0;
            
            /* --- 修改點 2：移除白色背景與邊框 --- */
            background-color: transparent; /* 改為透明 */
            border: none; /* 移除邊框 */
            
            transform-origin: left center;
            transform-style: preserve-3d;
            transition: transform 0.6s cubic-bezier(0.645, 0.045, 0.355, 1);
            
            /* 移除 overflow: hidden 以免切到陰影，但如果圖片要圓角則需加回 */
            /* 這裡建議保留 hidden 以配合 border-radius */
            overflow: hidden; 
            border-radius: 4px;

            display: flex;
            justify-content: center;
            align-items: center;
            
            backface-visibility: hidden; 
            z-index: 1;
        }

        .page img {
            width: 100%;
            height: 100%;
            
            /* --- 修改點 3：圖片填滿模式 --- */
            /* object-fit: fill; 會強制拉伸圖片填滿整個框（可能會變形，但沒有白邊） */
            /* object-fit: cover; 會等比放大填滿（可能會切掉部分邊緣，但沒有白邊且不變形） */
            /* 既然您的訴求是「只呈現圖片」，通常建議用 fill 讓它完全符合書本形狀 */
            object-fit: fill; 
            
            background: transparent; /* 確保圖片背景也是透明 */
        }

        .page.flipped {
            transform: rotateY(-180deg);
        }

        .page.active {
            z-index: 10;
        }

        /* 控制欄 */
        .controls {
            /* 固定高度，避免壓縮 */
            flex-shrink: 0; 
            height: 60px;
            
            display: flex;
            gap: 10px;
            align-items: center;
            background: rgba(255, 255, 255, 0.9);
            padding: 5px 20px;
            border-radius: 30px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.3);
            z-index: 100;
        }

        button {
            border: none;
            background: #333;
            color: #fff;
            padding: 8px 16px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 14px;
            transition: background 0.2s;
            white-space: nowrap; /* 防止按鈕文字換行 */
        }

        button:active { background: #555; }
        button:disabled { background: #ccc; cursor: not-allowed; }

        .page-info {
            font-size: 14px;
            color: #555;
            font-variant-numeric: tabular-nums;
            min-width: 40px;
            text-align: center;
        }

        .jump-box {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        input[type="number"] {
            width: 45px;
            padding: 6px;
            border: 1px solid #ddd;
            border-radius: 8px;
            text-align: center;
            font-size: 14px;
        }

        /* 手機適配微調 */
        @media (max-width: 600px) {
            .controls {
                width: 95%;
                justify-content: space-between;
                padding: 5px 10px;
            }
            button { padding: 8px 12px; font-size: 13px; }
            .jump-box input { width: 35px; }
        }
    </style>
</head>
<body>

    <div class="viewport-container">
        <div class="book-stage">
            <div class="book" id="book">
                <div class="page" style="z-index: 2;" id="page-0">
                    <img src="0.JPG" alt="Page 0">
                </div>
                <div class="page" style="z-index: 1;" id="page-1">
                    <img src="1.JPG" alt="Page 1">
                </div>
            </div>
        </div>

        <div class="controls">
            <button id="btn-prev" onclick="prevPage()">上一頁</button>
            <span class="page-info">
                <span id="current-page">1</span> / <span id="total-pages">2</span>
            </span>
            <button id="btn-next" onclick="nextPage()">下一頁</button>
            
            <div class="jump-box">
                <input type="number" id="jump-input" min="1" placeholder="頁">
                <button onclick="jumpToPage()">GO</button>
            </div>
        </div>
    </div>

    <script>
        // 設定圖片總數
        const totalImages = 2; 
        let currentPageIndex = 0; 

        const book = document.getElementById('book');
        const pageCountSpan = document.getElementById('total-pages');
        const currentSpan = document.getElementById('current-page');
        const btnPrev = document.getElementById('btn-prev');
        const btnNext = document.getElementById('btn-next');
        const pages = document.querySelectorAll('.page');

        function init() {
            pageCountSpan.innerText = totalImages;
            updateZIndexes();
            updateControls();

            // 觸控翻頁
            let touchStartX = 0;
            let touchEndX = 0;
            
            book.addEventListener('touchstart', e => {
                touchStartX = e.changedTouches[0].screenX;
            });
            
            book.addEventListener('touchend', e => {
                touchEndX = e.changedTouches[0].screenX;
                handleSwipe();
            });

            function handleSwipe() {
                if (touchEndX < touchStartX - 50) nextPage();
                if (touchEndX > touchStartX + 50) prevPage();
            }
        }

        function updateZIndexes() {
            pages.forEach((page, index) => {
                if (index > currentPageIndex) {
                    page.style.zIndex = totalImages - index;
                    page.style.display = 'flex';
                } else if (index === currentPageIndex) {
                      page.style.zIndex = totalImages + 1;
                      page.style.display = 'flex';
                } else {
                    page.style.zIndex = index;
                }
            });
        }

        function nextPage() {
            if (currentPageIndex >= totalImages - 1) return;
            const currentEl = document.getElementById(`page-${currentPageIndex}`);
            currentEl.classList.add('flipped');
            currentPageIndex++;
            updateUI();
        }

        function prevPage() {
            if (currentPageIndex <= 0) return;
            currentPageIndex--;
            const prevEl = document.getElementById(`page-${currentPageIndex}`);
            prevEl.classList.remove('flipped');
            updateUI();
        }

        function jumpToPage() {
            const input = document.getElementById('jump-input');
            let targetPage = parseInt(input.value);

            if (isNaN(targetPage) || targetPage < 1 || targetPage > totalImages) {
                alert('請輸入有效的頁碼');
                return;
            }

            let targetIndex = targetPage - 1;

            if (targetIndex > currentPageIndex) {
                for (let i = currentPageIndex; i < targetIndex; i++) {
                    document.getElementById(`page-${i}`).classList.add('flipped');
                }
            } 
            else if (targetIndex < currentPageIndex) {
                for (let i = currentPageIndex - 1; i >= targetIndex; i--) {
                    document.getElementById(`page-${i}`).classList.remove('flipped');
                }
            }

            currentPageIndex = targetIndex;
            updateUI();
            input.value = '';
        }

        function updateUI() {
            currentSpan.innerText = currentPageIndex + 1;
            btnPrev.disabled = currentPageIndex === 0;
            btnNext.disabled = currentPageIndex === totalImages - 1;
            updateZIndexes();
        }

        init();
    </script>
</body>
</html>

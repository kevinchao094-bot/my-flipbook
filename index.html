<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>GitHub 電子書 - PageFlip版</title>
    <script src="https://cdn.jsdelivr.net/npm/page-flip/dist/js/page-flip.browser.js"></script>
    <style>
        * { box-sizing: border-box; }

        body {
            margin: 0;
            padding: 0;
            background-color: #444; /* 深灰色背景，突顯電子書邊緣 */
            height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            overflow: hidden;
        }

        /* 主容器：上下留白 25px，中間自適應 */
        .stage {
            width: 100%;
            flex-grow: 1; /* 佔據剩餘空間 */
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 25px 0 10px 0; /* 上方 25px，下方留一點給控制列 */
            position: relative;
        }

        /* 書本的外部容器：負責產生「浮起來」的陰影 */
        .book-wrapper {
            /* 這裡設定書本的最大顯示比例 */
            width: 90vw; 
            height: auto;
            aspect-ratio: 3/4; /* 固定長寬比，避免變形 */
            max-width: 500px;  /* 電腦版限制最大寬度 */
            max-height: 80vh;  /* 限制高度，避免蓋到控制列 */
            
            /* 浮起來的關鍵：強烈的陰影 */
            box-shadow: 0 20px 50px rgba(0,0,0,0.6), 0 5px 15px rgba(0,0,0,0.3); 
            background-color: #fff; /* 書本背景 */
            border-radius: 5px;     /* 書本圓角 */
        }

        /* PageFlip 會掛載在這個元素上 */
        .flip-book {
            width: 100%;
            height: 100%;
            display: none; /* 載入前隱藏，避免閃爍 */
            background-size: cover;
        }

        /* 單頁樣式 */
        .page {
            background-color: #fff;
            padding: 0;
            overflow: hidden;
            border-right: 1px solid #ddd; /* 頁面右側邊緣線 */
        }

        .page img {
            width: 100%;
            height: 100%;
            object-fit: contain; /* 確保圖片完整顯示不變形 */
        }

        /* -------- 控制欄 -------- */
        .controls-container {
            height: 60px; /* 固定高度 */
            width: 100%;
            display: flex;
            justify-content: center;
            align-items: flex-start; /* 靠上對齊 */
            padding-bottom: 25px; /* 下方強制留白 */
            z-index: 10;
        }

        .controls {
            background: rgba(255, 255, 255, 0.95);
            padding: 8px 20px;
            border-radius: 30px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            display: flex;
            gap: 15px;
            align-items: center;
        }

        button {
            border: none;
            background: #222;
            color: #fff;
            padding: 8px 15px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 14px;
            transition: background 0.2s;
            min-width: 60px;
        }

        button:active { background: #000; }
        button:disabled { background: #888; cursor: not-allowed; opacity: 0.6; }

        .page-info {
            font-variant-numeric: tabular-nums;
            font-weight: bold;
            color: #333;
        }

        .jump-box {
            display: flex;
            align-items: center;
            gap: 5px;
            border-left: 1px solid #ccc;
            padding-left: 10px;
        }

        .jump-box input {
            width: 45px;
            padding: 5px;
            border: 1px solid #aaa;
            border-radius: 5px;
            text-align: center;
        }

        .jump-box button {
            min-width: auto;
            background: #555;
        }
    </style>
</head>
<body>

    <div class="stage">
        <div class="book-wrapper">
            <div id="book" class="flip-book">
                <div class="page" data-density="hard">
                    <img src="0.JPG" alt="Cover">
                </div>
                <div class="page" data-density="soft">
                    <img src="1.JPG" alt="Page 1">
                </div>
                </div>
        </div>
    </div>

    <div class="controls-container">
        <div class="controls">
            <button id="btn-prev">上一頁</button>
            <span class="page-info">
                <span id="current-page">1</span> / <span id="total-pages">--</span>
            </span>
            <button id="btn-next">下一頁</button>
            
            <div class="jump-box">
                <input type="number" id="jump-input" min="1" placeholder="頁">
                <button id="btn-jump">GO</button>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const pageFlip = new St.PageFlip(document.getElementById('book'), {
                width: 600, // 基準寬度 (解析度)
                height: 800, // 基準高度 (解析度)
                size: 'stretch', // 自動延展填滿父容器
                minWidth: 300,
                maxWidth: 1000,
                minHeight: 400,
                maxHeight: 1200,
                maxShadowOpacity: 0.5, // 陰影強度
                showCover: true, // 啟用封面模式
                mobileScrollSupport: false, // 禁止手機滾動干擾
                usePortrait: true, // 強制單頁模式 (適合手機)
                startPage: 0
            });

            // 取得頁面元素
            const pages = document.querySelectorAll('.page');
            const totalPages = pages.length;

            // 載入頁面
            pageFlip.loadFromHTML(pages);

            // UI 元素
            const elCurrent = document.getElementById('current-page');
            const elTotal = document.getElementById('total-pages');
            const btnPrev = document.getElementById('btn-prev');
            const btnNext = document.getElementById('btn-next');
            const btnJump = document.getElementById('btn-jump');
            const inputJump = document.getElementById('jump-input');

            elTotal.innerText = totalPages;

            // 更新按鈕狀態
            const updateUI = () => {
                // PageFlip 的 getCurrentPageIndex() 是從 0 開始
                // 但為了讓使用者好理解，我們顯示 +1
                const current = pageFlip.getCurrentPageIndex() + 1;
                elCurrent.innerText = current;

                btnPrev.disabled = current === 1;
                btnNext.disabled = current === totalPages;
            };

            // 監聽翻頁事件
            pageFlip.on('flip', (e) => {
                updateUI();
            });

            // 初始化完成後顯示書本 (避免載入時跑版)
            pageFlip.on('init', () => {
                document.getElementById('book').style.display = 'block';
                updateUI();
            });

            // 按鈕事件綁定
            btnPrev.addEventListener('click', () => pageFlip.flipPrev());
            btnNext.addEventListener('click', () => pageFlip.flipNext());

            btnJump.addEventListener('click', () => {
                const val = parseInt(inputJump.value);
                if (val >= 1 && val <= totalPages) {
                    // 轉到指定頁 (API 接受 0-based index，所以要減 1)
                    pageFlip.turnToPage(val - 1);
                    inputJump.value = '';
                } else {
                    alert('頁碼無效');
                }
            });
        });
    </script>
</body>
</html>
